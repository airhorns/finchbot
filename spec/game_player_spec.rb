require File.expand_path(File.dirname(__FILE__) + '/spec_helper')
require 'darwin/game_player'

describe "Finch::GamePlayer" do
  before do
    @player = Finch::GamePlayer.new
  end
  it "should successfuly parse errors" do
    output = "WARNING: player 2 timed out.
    Turn 1
    11.8039955755,11.2157212798,0,37,3:9.31956732508,21.8088737532,1,100,5:14.2884238258,0.622568806433,2,100,5:11.8654926942,5.2737846552,0,81,3:11.7424984567,17.1576579045,0,81,3:4.25409258443,0.0,0,22,1:19.3538985665,22.4314425597,0,22,1:14.7436138612,22.3240014889,0,83,3:8.86437728973,0.107441070771,0,83,3:19.8543468498,0.711933891201,0,84,1:3.75364430115,21.7195086685,0,84,1:8.86481414847,9.73662367883,0,12,5:14.7431770024,12.6948188808,0,12,5:0.0,10.8098889721,0,59,2:23.6079911509,11.6215535875,0,59,2:20.3967683707,15.5228613809,0,59,3:3.21122278016,6.90858117873,0,59,3:17.0287479269,6.65976901033,0,4,2:6.57924322402,15.7716735493,0,4,2:0.782927536597,19.6075053882,0,55,1:22.8250636143,2.82393717142,0,55,1:2.60103334076,13.172383428,0,58,3:21.0069578101,9.25905913169,0,58,3|Player 1 Wins!
    0.37,1.55,0.100,0.81,0.81,0.22,0.22,0.83,0.83,0.84,0.84,0.12,0.12,0.59,0.59,0.59,0.59,0.4,0.4,0.55,0.55,0.58,0.58,1.50.1.6.11.10:"
    @player.parse_output(output).should == -1001
  end

  it "should successfully count the number of turns" do
    output = "5.28.9,2.7.6.5.28.9,2.5.6.5.28.9,2.8.6.5.28.10,2.8.6.5.28.10,2.8.6.5.28.10,2.8.6.5.28.10,2.3.6.5.28.10,2.63.6.3.19.5,2.47.5.17.15.2,2.4.5.17.15.2,2.47.13.17.18.5,2.8.13.20.25.12,2.50.6.17.16.6,2.51.13.17.18.8,2.55.2.19.24.16,2.63.5.3.10.2,2.47.5.4.19.11,2.55.11.20.16.8,2.55.12.19.16.9,2.63.5.3.10.4,2.55.16.19.13.7,2.1.16.20.21.15,2.55.1.19.9.4,2.2.1.20.24.19,1.33.17.20.7.4,2.75.5.4.19.16,2.2.5.7.25.22,2.38.21.8.15.12,2.38.5.8.5.3,2.21.5.14.23.21,2.38.18.8.16.14:Turn 101
    0.0,2.6,2.5,2.9,0.75,2.2,2.2,0.83,0.38,0.84,0.84,2.5,2.26,2.11,0.3,0.59,2.13,1.42,2.3,0.55,0.55,2.25,0.58,2.7.6.5.28.8,2.7.6.5.28.8,2.7.6.5.28.8,2.7.6.5.28.8,2.7.6.5.28.8,2.7.6.5.28.8,2.5.6.5.28.8,2.8.6.5.28.9,2.8.6.5.28.9,2.8.6.5.28.9,2.8.6.5.28.9,2.3.6.5.28.9,2.63.6.3.19.4,2.47.5.17.15.1,2.4.5.17.15.1,2.47.13.17.18.4,2.8.13.20.25.11,2.50.6.17.16.5,2.51.13.17.18.7,2.55.2.19.24.15,2.63.5.3.10.1,2.47.5.4.19.10,2.55.11.20.16.7,2.55.12.19.16.8,2.63.5.3.10.3,2.55.16.19.13.6,2.1.16.20.21.14,2.55.1.19.9.3,2.2.1.20.24.18,1.33.17.20.7.3,2.75.5.4.19.15,2.2.5.7.25.21,2.38.21.8.15.11,2.38.5.8.5.2,2.21.5.14.23.20,2.38.18.8.16.13,2.3.1.14.18.17,2.3.1.14.18.17,2.38.2.8.6.5,2.3.2.14.15.14,2.3.1.14.18.17,2.3.3.14.14.13,2.3.1.14.18.17,2.3.3.14.14.13,2.3.5.14.23.22,2.3.1.14.18.17,2.3.3.14.14.13,2.3.5.14.23.22,2.3.6.14.12.11,2.3.1.14.18.17,2.3.3.14.14.13,2.3.5.14.23.22,2.3.6.14.12.11,2.38.11.8.10.9,2.3.11.14.15.14,2.3.1.14.18.17,2.3.3.14.14.13,2.1.5.14.23.22,2.3.6.14.12.11,2.3.12.14.9.8,2.3.1.14.18.17,2.3.3.14.14.13,2.1.6.14.12.11,2.3.12.14.9.8,2.3.13.14.24.23,2.1.1.14.18.17,2.3.3.14.14.13,2.3.12.14.9.8,2.3.13.14.24.23,2.3.16.14.21.20,2.3.3.14.14.13,2.3.12.14.9.8,2.3.13.14.24.23,2.3.16.14.21.20,2.3.18.14.18.17,2.3.3.14.14.13,2.3.12.14.9.8,2.3.13.14.24.23,2.3.16.14.21.20,2.3.21.14.22.21:Turn 102
    0.0,2.5,2.6,2.66,0.75,2.2,2.2,0.83,0.38,0.84,0.84,2.6,2.16,2.3,0.3,0.59,2.7,2.7,2.2,0.55,0.55,2.25,0.58,2.7.6.5.28.7,2.7.6.5.28.7,2.7.6.5.28.7,2.7.6.5.28.7,2.7.6.5.28.7,2.7.6.5.28.7,2.5.6.5.28.7,2.8.6.5.28.8,2.8.6.5.28.8,2.8.6.5.28.8,2.8.6.5.28.8,2.3.6.5.28.8,2.63.6.3.19.3,2.47.13.17.18.3,2.8.13.20.25.10,2.50.6.17.16.4,2.51.13.17.18.6,2.55.2.19.24.14,2.47.5.4.19.9,2.55.11.20.16.6,2.55.12.19.16.7,2.63.5.3.10.2,2.55.16.19.13.5,2.1.16.20.21.13,2.55.1.19.9.2,2.2.1.20.24.17,1.33.17.20.7.2,2.75.5.4.19.14,2.2.5.7.25.20,2.38.21.8.15.10,2.38.5.8.5.1,2.21.5.14.23.19,2.38.18.8.16.12,2.3.1.14.18.16,2.3.1.14.18.16,2.38.2.8.6.4,2.3.2.14.15.13,2.3.1.14.18.16,2.3.3.14.14.12,2.3.1.14.18.16,2.3.3.14.14.12,2.3.5.14.23.21,2.3.1.14.18.16,2.3.3.14.14.12,2.3.5.14.23.21,2.3.6.14.12.10,2.3.1.14.18.16,2.3.3.14.14.12,2.3.5.14.23.21,2.3.6.14.12.10,2.38.11.8.10.8,2.3.11.14.15.13,2.3.1.14.18.16,2.3.3.14.14.12,2.1.5.14.23.21,2.3.6.14.12.10,2.3.12.14.9.7,2.3.1.14.18.16,2.3.3.14.14.12,2.1.6.14.12.10,2.3.12.14.9.7,2.3.13.14.24.22,2.1.1.14.18.16,2.3.3.14.14.12,2.3.12.14.9.7,2.3.13.14.24.22,2.3.16.14.21.19,2.3.3.14.14.12,2.3.12.14.9.7,2.3.13.14.24.22,2.3.16.14.21.19,2.3.18.14.18.16,2.3.3.14.14.12,2.3.12.14.9.7,2.3.13.14.24.22,2.3.16.14.21.19,2.3.21.14.22.20,2.3.1.14.18.17,2.3.1.14.18.17,2.3.2.14.15.14,2.1.2.14.15.14,2.3.3.14.14.13,2.3.3.14.14.13,2.1.5.14.23.22,2.3.3.14.14.13,2.1.6.14.12.11,2.3.11.14.15.14,2.1.11.14.15.14,2.3.12.14.9.8,2.3.12.14.9.8,2.3.13.14.24.23,2.3.12.14.9.8,2.3.13.14.24.23,2.3.16.14.21.20,2.3.12.14.9.8,2.3.13.14.24.23,2.3.16.14.21.20,2.3.18.14.18.17,2.3.12.14.9.8,2.1.13.14.24.23,2.3.16.14.21.20,2.3.21.14.22.21:Turn 103
    0.0,2.6,2.5,2.4,0.75,2.2,2.2,0.83,0.0,0.84,0.84,2.5,2.6,2.2,0.3,0.59,2.4,2.3,2.3,0.55,0.55,2.25,0.58,2.7.6.5.28.6,2.7.6.5.28.6,2.7.6.5.28.6,2.7.6.5.28.6,2.7.6.5.28.6,2.7.6.5.28.6,2.5.6.5.28.6,2.8.6.5.28.7,2.8.6.5.28.7,2.8.6.5.28.7,2.8.6.5.28.7,2.3.6.5.28.7,2.63.6.3.19.2,2.47.13.17.18.2,2.8.13.20.25.9,2.50.6.17.16.3,2.51.13.17.18.5,2.55.2.19.24.13,2.47.5.4.19.8,2.55.11.20.16.5,2.55.12.19.16.6,2.63.5.3.10.1,2.55.16.19.13.4,2.1.16.20.21.12,2.55.1.19.9.1,2.2.1.20.24.16,1.33.17.20.7.1,2.75.5.4.19.13,2.2.5.7.25.19,2.38.21.8.15.9,2.21.5.14.23.18,2.38.18.8.16.11,2.3.1.14.18.15,2.3.1.14.18.15,2.38.2.8.6.3,2.3.2.14.15.12,2.3.1.14.18.15,2.3.3.14.14.11,2.3.1.14.18.15,2.3.3.14.14.11,2.3.5.14.23.20,2.3.1.14.18.15,2.3.3.14.14.11,2.3.5.14.23.20,2.3.6.14.12.9,2.3.1.14.18.15,2.3.3.14.14.11,2.3.5.14.23.20,2.3.6.14.12.9,2.38.11.8.10.7,2.3.11.14.15.12,2.3.1.14.18.15,2.3.3.14.14.11,2.1.5.14.23.20,2.3.6.14.12.9,2.3.12.14.9.6,2.3.1.14.18.15,2.3.3.14.14.11,2.1.6.14.12.9,2.3.12.14.9.6,2.3.13.14.24.21,2.1.1.14.18.15,2.3.3.14.14.11,2.3.12.14.9.6,2.3.13.14.24.21,2.3.16.14.21.18,2.3.3.14.14.11,2.3.12.14.9.6,2.3.13.14.24.21,2.3.16.14.21.18,2.3.18.14.18.15,2.3.3.14.14.11,2.3.12.14.9.6,2.3.13.14.24.21,2.3.16.14.21.18,2.3.21.14.22.19,2.3.1.14.18.16,2.3.1.14.18.16,2.3.2.14.15.13,2.1.2.14.15.13,2.3.3.14.14.12,2.3.3.14.14.12,2.1.5.14.23.21,2.3.3.14.14.12,2.1.6.14.12.10,2.3.11.14.15.13,2.1.11.14.15.13,2.3.12.14.9.7,2.3.12.14.9.7,2.3.13.14.24.22,2.3.12.14.9.7,2.3.13.14.24.22,2.3.16.14.21.19,2.3.12.14.9.7,2.3.13.14.24.22,2.3.16.14.21.19,2.3.18.14.18.16,2.3.12.14.9.7,2.1.13.14.24.22,2.3.16.14.21.19,2.3.21.14.22.20,2.3.1.14.18.17,2.1.1.14.18.17,2.3.2.14.15.14,2.3.2.14.15.14,2.38.3.8.6.5,2.3.3.14.14.13,2.24.3.15.14.13,2.1.5.14.23.22,2.1.6.14.12.11,2.3.11.14.15.14,2.3.11.14.15.14,2.3.12.14.9.8,2.3.12.14.9.8,2.3.13.14.24.23,2.3.12.14.9.8,2.3.16.14.21.20,2.3.12.14.9.8,2.3.16.14.21.20,2.3.17.14.9.8,2.3.12.14.9.8,2.3.17.14.9.8,2.1.18.14.18.17,2.3.21.14.22.21:Player 2 Wins!
    0.0,2.5,2.6,2.67,0.75,2.2,2.2,0.83,0.0,0.84,0.84,2.6,2.5,2.3,0.3,0.59,2.4,2.2,2.2,0.0,0.22,2.25,0.58,2.7.6.5.28.5,2.7.6.5.28.5,2.7.6.5.28.5,2.7.6.5.28.5,2.7.6.5.28.5,2.7.6.5.28.5,2.5.6.5.28.5,2.8.6.5.28.6,2.8.6.5.28.6,2.8.6.5.28.6,2.8.6.5.28.6,2.3.6.5.28.6,2.63.6.3.19.1,2.47.13.17.18.1,2.8.13.20.25.8,2.50.6.17.16.2,2.51.13.17.18.4,2.55.2.19.24.12,2.47.5.4.19.7,2.55.11.20.16.4,2.55.12.19.16.5,2.55.16.19.13.3,2.1.16.20.21.11,2.2.1.20.24.15,2.75.5.4.19.12,2.2.5.7.25.18,2.38.21.8.15.8,2.21.5.14.23.17,2.38.18.8.16.10,2.3.1.14.18.14,2.3.1.14.18.14,2.38.2.8.6.2,2.3.2.14.15.11,2.3.1.14.18.14,2.3.3.14.14.10,2.3.1.14.18.14,2.3.3.14.14.10,2.3.5.14.23.19,2.3.1.14.18.14,2.3.3.14.14.10,2.3.5.14.23.19,2.3.6.14.12.8,2.3.1.14.18.14,2.3.3.14.14.10,2.3.5.14.23.19,2.3.6.14.12.8,2.38.11.8.10.6,2.3.11.14.15.11,2.3.1.14.18.14,2.3.3.14.14.10,2.1.5.14.23.19,2.3.6.14.12.8,2.3.12.14.9.5,2.3.1.14.18.14,2.3.3.14.14.10,2.1.6.14.12.8,2.3.12.14.9.5,2.3.13.14.24.20,2.1.1.14.18.14,2.3.3.14.14.10,2.3.12.14.9.5,2.3.13.14.24.20,2.3.16.14.21.17,2.3.3.14.14.10,2.3.12.14.9.5,2.3.13.14.24.20,2.3.16.14.21.17,2.3.18.14.18.14,2.3.3.14.14.10,2.3.12.14.9.5,2.3.13.14.24.20,2.3.16.14.21.17,2.3.21.14.22.18,2.3.1.14.18.15,2.3.1.14.18.15,2.3.2.14.15.12,2.1.2.14.15.12,2.3.3.14.14.11,2.3.3.14.14.11,2.1.5.14.23.20,2.3.3.14.14.11,2.1.6.14.12.9,2.3.11.14.15.12,2.1.11.14.15.12,2.3.12.14.9.6,2.3.12.14.9.6,2.3.13.14.24.21,2.3.12.14.9.6,2.3.13.14.24.21,2.3.16.14.21.18,2.3.12.14.9.6,2.3.13.14.24.21,2.3.16.14.21.18,2.3.18.14.18.15,2.3.12.14.9.6,2.1.13.14.24.21,2.3.16.14.21.18,2.3.21.14.22.19,2.3.1.14.18.16,2.1.1.14.18.16,2.3.2.14.15.13,2.3.2.14.15.13,2.38.3.8.6.4,2.3.3.14.14.12,2.24.3.15.14.12,2.1.5.14.23.21,2.1.6.14.12.10,2.3.11.14.15.13,2.3.11.14.15.13,2.3.12.14.9.7,2.3.12.14.9.7,2.3.13.14.24.22,2.3.12.14.9.7,2.3.16.14.21.19,2.3.12.14.9.7,2.3.16.14.21.19,2.3.17.14.9.7,2.3.12.14.9.7,2.3.17.14.9.7,2.1.18.14.18.16,2.3.21.14.22.20,2.3.1.14.18.17,2.3.1.14.18.17,2.3.2.14.15.14,2.1.2.14.15.14,2.3.3.14.14.13,2.1.5.14.23.22,2.1.6.14.12.11,2.3.11.14.15.14,2.1.11.14.15.14,2.3.12.14.9.8,2.3.12.14.9.8,2.1.13.14.24.23,2.3.16.14.21.20,2.3.17.14.9.8,2.3.18.14.18.17,2.3.21.14.22.21:"
    @player.parse_output(output).should == 997


    output = "9.13.22.22.2,2.89.13.22.22.2,2.40.13.22.22.2,1.19.15.8.20.3,2.39.10.15.18.1,2.27.10.15.18.1,2.39.13.15.21.4,2.23.2.15.17.1,2.12.2.15.17.1,2.23.8.15.20.4,2.16.8.15.20.4,2.23.13.15.21.5,2.23.13.15.21.5,2.23.13.15.21.5,2.23.16.15.20.4,2.23.13.15.21.5,2.16.16.15.20.4,2.23.13.15.21.5,2.19.13.15.21.5,2.23.21.15.18.2,2.4.21.15.18.2,2.26.13.15.21.6,2.26.13.15.21.6,2.26.13.15.21.6,2.26.13.15.21.6,2.26.13.15.21.6,2.21.13.15.21.6,2.29.13.15.21.7,2.29.13.15.21.7,2.29.13.15.21.7,2.29.13.15.21.7,2.6.13.15.21.7,2.35.13.15.21.9,2.35.13.15.21.9,2.35.13.15.21.9,2.35.13.15.21.9,2.7.13.15.21.9,2.38.13.15.21.10,2.15.13.15.21.10,2.334.15.12.7.1,2.15.15.12.7.1:Turn 190
    2.52,2.86,2.86,2.52,2.55,2.30,2.30,2.52,2.52,2.30,2.19,2.86,2.370,2.216,2.35,2.331,2.52,2.35,2.35,2.30,2.30,2.52,2.482,2.89.13.22.22.1,2.89.13.22.22.1,2.40.13.22.22.1,1.19.15.8.20.2,2.39.13.15.21.3,2.23.8.15.20.3,2.16.8.15.20.3,2.23.13.15.21.4,2.23.13.15.21.4,2.23.13.15.21.4,2.23.16.15.20.3,2.23.13.15.21.4,2.16.16.15.20.3,2.23.13.15.21.4,2.19.13.15.21.4,2.23.21.15.18.1,2.4.21.15.18.1,2.26.13.15.21.5,2.26.13.15.21.5,2.26.13.15.21.5,2.26.13.15.21.5,2.26.13.15.21.5,2.21.13.15.21.5,2.29.13.15.21.6,2.29.13.15.21.6,2.29.13.15.21.6,2.29.13.15.21.6,2.6.13.15.21.6,2.35.13.15.21.8,2.35.13.15.21.8,2.35.13.15.21.8,2.35.13.15.21.8,2.7.13.15.21.8,2.38.13.15.21.9,2.15.13.15.21.9:Turn 191
    2.55,2.91,2.91,2.55,2.58,2.31,2.31,2.55,2.55,2.31,2.20,2.91,2.375,2.218,2.37,2.361,2.55,2.37,2.37,2.31,2.31,2.55,2.703,1.19.15.8.20.1,2.39.13.15.21.2,2.23.8.15.20.2,2.16.8.15.20.2,2.23.13.15.21.3,2.23.13.15.21.3,2.23.13.15.21.3,2.23.16.15.20.2,2.23.13.15.21.3,2.16.16.15.20.2,2.23.13.15.21.3,2.19.13.15.21.3,2.26.13.15.21.4,2.26.13.15.21.4,2.26.13.15.21.4,2.26.13.15.21.4,2.26.13.15.21.4,2.21.13.15.21.4,2.29.13.15.21.5,2.29.13.15.21.5,2.29.13.15.21.5,2.29.13.15.21.5,2.6.13.15.21.5,2.35.13.15.21.7,2.35.13.15.21.7,2.35.13.15.21.7,2.35.13.15.21.7,2.7.13.15.21.7,2.38.13.15.21.8,2.15.13.15.21.8:Player 1 Wins!
    2.58,2.96,2.96,2.58,2.61,2.32,2.32,2.58,2.39,2.32,2.21,2.96,2.380,2.220,2.39,2.364,2.58,2.39,2.39,2.32,2.32,2.58,2.706,2.39.13.15.21.1,2.23.8.15.20.1,2.16.8.15.20.1,2.23.13.15.21.2,2.23.13.15.21.2,2.23.13.15.21.2,2.23.16.15.20.1,2.23.13.15.21.2,2.16.16.15.20.1,2.23.13.15.21.2,2.19.13.15.21.2,2.26.13.15.21.3,2.26.13.15.21.3,2.26.13.15.21.3,2.26.13.15.21.3,2.26.13.15.21.3,2.21.13.15.21.3,2.29.13.15.21.4,2.29.13.15.21.4,2.29.13.15.21.4,2.29.13.15.21.4,2.6.13.15.21.4,2.35.13.15.21.6,2.35.13.15.21.6,2.35.13.15.21.6,2.35.13.15.21.6,2.7.13.15.21.6,2.38.13.15.21.7,2.15.13.15.21.7:"
    @player.parse_output(output).should == -998
  end
end
